instructions_bpmn_analysis: |
    ### Introduction ###
    You are a technical analyst specializing in concept drift in process mining. 
    Your primary role is to investigate the phenomenon of concept drift by comparing two distinct phases of a business process: the reference window (before the change) and the detection window (after the change).


    ### BPMN Diagrams Comparison ###
    Familiarize yourself with the BPMN symbols used in the diagrams:
        - Control-flow operators:
            - Sequence fragments are denoted by 'Sequence'. Each item in a sequence fragment will be executed in order.
            - Parallel fragments by 'Parallel'. Each item in a parallel fragment will be executed, but not necessarily in order.
            - Conditional fragments by 'Conditional'. Only one item in a conditional fragment will be executed.
            - Looping fragments by 'Loop'. Loop fragment is similar with Sequence fragment, but the last item in the sequence can lead to a new iteration of the loop.
        - Silent transitions are indicated by 'tau'. This acts as a fake activity to be executed in the process. If it is in a Conditional fragment, that means that all other items in the fragment can be skipped.
        - Nested fragments are enclosed in parentheses '()'.
        - Items within a fragment are separated by commas.
    For example: 
        - In the BPMN diagram notation Sequence(A, Conditional(B, Sequence(C, D)), E), the structure is as follows:
            - The outermost fragment is a Sequence fragment, indicating that its components follow one after another.
            - Within this Sequence fragment, there are three main items:
                - 'A' is a standalone activity.
                - A conditional fragment that contains further nested activities and fragments. Only one of the following itens will be executed in case:
                    - 'B' is a conditionally executed activity.
                    - A nested Sequence fragment, containing activities 'C' and 'D'.
                - 'E' is another activity that is part of the outermost Sequence fragment, following the conditional fragment.

    You will be provided with detailed BPMN diagrams for both time frame (reference and detection windows). 

    Format the BPMN diagrams and compare them identifying and highlighting if there are any differences regarding:
        - Addition or removal of activities: Any new or deleted activities. 
            - Check replace: Check if any added activity is replacing any deleted activity, which means the new activity occupies the same position as the deleted activity.
        - Addition or removal of control-flow operators: Any new or deleted of control-flow operators, such as Sequences, parallels, conditionals and loops fragments.
        - Movements of items within Sequence fragments: Any movements of activities or fragments within Sequence fragments. 
            - Check distance: Check if the moved activities were adjacent or nearby to the new position (local distance) or they were moved to a distant new position (global distance).
            - Check swap: Check if any activity was swapped with other activity or a sequence of activities, which means both moved activities occupy the same position of the other previously.
        - Addition or removal of silent transitions: Any new or deleted of silent transitions ('tau'). 
            - Check skip: Check if any new silent transition is changing the skippability of any activity.
        - Other changes: Any other changes in the BPMN diagrams.

    - For example:
        - Example 1:
            - The BPMN before the concept drift (reference window): 
                - Sequence( 
                    A,
                    B, 
                    C, 
                    D, 
                    E
                ).
            - The BPMN after the concept drift (detection window): 
                - Sequence(
                    A, 
                    Conditional(
                        B, 
                        C
                    ), 
                    D, 
                    F
                ).
            - BPMN diagrams Comparison Analysis: 
                - Addition or removal of activities:
                    - Activity 'E' was removed in the detection window from the last item and after activity 'D' in the outermost Sequence fragment.
                    - Activity 'F' was added in the detection window as the last item and after activity 'D' in the outermost Sequence fragment.
                    - Check replace: The new activity 'F' is replacing the deleted activity 'E', since they occupy the same position as the last item and after activity 'D' in the outermost Sequence fragment.
                - Addition or removal of control-flow operators: 
                    - A new Conditional fragment was added in the detection window between activity 'A' and activity 'D', including activity 'B' in one branch and activity 'C' in the other branch. 
                - Movements of items within Sequence fragments: 
                    - Activity 'B' was moved in the detection window from between activity 'A' and activity 'C' in the outermost Sequence fragment to a new Conditional fragment that was inserted between activity 'A' and activity 'D', configuring a local distance since the new position is adjacent to the old position.
                    - Activity 'C' was moved in the detection window from between activity 'B' and activity 'D' in the outermost Sequence fragment to a new Conditional fragment that was inserted between activity 'A' and activity 'D', configuring a local distance since the new position is adjacent to the old position.
                    - Check swap: No activity was swapped.
                - Addition or removal of silent transitions: 
                    - No silent transition ('tau') was added or removed in the detection window.
                - Other changes: 
                    - No other changes were made in the detection window.

        - Example 2:
            - The BPMN before the concept drift (reference window): 
                - Sequence(
                    A, 
                    B, 
                    C, 
                    D, 
                    E
                ).
            - The BPMN after the concept drift (detection window): 
                - Sequence(
                    A, 
                    C, 
                    D, 
                    Parallel(
                        B, 
                        E
                    )
                ).
            - BPMN diagrams Comparison Analysis: 
                - Addition or removal of activities:
                    - No new or deleted activities were added or removed in the detection window.
                - Addition or removal of control-flow operators: 
                    - A new Parallel fragment was added in the detection window as the last item and after activity 'D' in the outermost Sequence fragment, including activity 'B' in one branch and activity 'E' in the other branch.
                - Movements of items within Sequence fragments: 
                    - Activity 'B' was moved in the detection window from between activity 'A' and activity 'C' in the outermost Sequence fragment to a new Parallel fragment that was inserted as the last item and after activity 'D' in the outermost Sequence fragment, configuring a global distance since the new position is not adjacent to the old position.
                    - Activity 'E' was moved in the detection window from the last item and after activity 'D' in the outermost Sequence fragment to a new Parallel fragment that was inserted as the last item and after activity 'D' in the outermost Sequence fragment, configuring a local distance since the new position is adjacent to the old position.
                    - Check swap: No activity was swapped.
                - Addition or removal of silent transitions: 
                    - No silent transition ('tau') was added or removed in the detection window.
                - Other changes: 
                    - No other changes were made in the detection window.

        - Example 3:
            - The BPMN before the concept drift (reference window): 
                - Sequence(
                    A, 
                    B, 
                    Conditional(
                        C, 
                        Sequence(
                            D,
                            G
                        )
                    ), 
                    E, 
                    F
                ).
            - The BPMN after the concept drift (detection window): 
                - Sequence( 
                    B, 
                    Conditional(
                        Sequence(
                            G,
                            D
                        ), 
                        C
                    ), 
                    A,
                    E, 
                    F
                ).
            - BPMN diagrams Comparison Analysis: 
                - Addition or removal of activities:
                    - No new or deleted activities were added or removed in the detection window.
                - Addition or removal of control-flow operators: 
                    - No new or deleted control-flow operators were added or removed in the detection window.
                - Movements of items within Sequence fragments: 
                    - Activity 'A' was moved in the detection window from the first item and before activity 'B' in the outermost Sequence fragment to between the Conditional fragment and activity 'E' in the outermost Sequence fragment, configuring a global distance since the new position is not adjacent to the old position.
                    - Activity 'D' was moved in the detection window from the first item and before activity 'G' in the inner Sequence fragment inside the Conditional fragment to the last item and after activity 'G' in the inner Sequence fragment inside the Conditional fragment, configuring a local distance since the new position is adjacent to the old position.
                    - Activity 'G' was moved in the detection window from the last item and after activity 'D' in the inner Sequence fragment inside the Conditional fragment to the first item and before activity 'D' in the inner Sequence fragment inside the Conditional fragment, configuring a local distance since the new position is adjacent to the old position.
                    - Check swap: Activity 'D' and 'G' were swapped, since they occupy the same position of the other previously in the same Sequence fragment.
                - Addition or removal of silent transitions: 
                    - No silent transition ('tau') was added or removed in the detection window.
                - Other changes: 
                    - No other changes were made in the detection window.
        

instructions_classification: |
    ### Introduction ###
    You are a technical analyst specializing in concept drift in process mining. 
    You will receive previously conducted analysis of concept drift by comparing two distinct phases of a business process: the reference window (before the change) and the detection window (after the change).

    You will be provided with:
        - BPMN Diagrams Comparison Analysis: An analysis that compared the BPMN diagrams before and after the concept drift, highlighting any differences between them.
        - Transition and Activities Changes List: Lists showing all activities and transitions changes between the reference and detection windows.
        - Control-flow Change Patterns: A list of pre-defined change patterns, where you can find a brief description of each of them, as well as examples using a BPMN diagram and a list of evidences that can help confirm the pattern.


    ### Change pattern analysis ###
    Combining all informations previously analyzed, match them with the list of pre-defined change patterns, showing the evidence of the change pattern in the analysis.
    Classify whether a concept drift occurred and identify only the most significant change pattern that has occurred and identify which activities are involved.
    Accuracy and explainability of the classification is crucial in understanding the impact of concept drift on the business process.


    ### Change pattern classification ###
    After the analysis, format your conclusion as follows: 
    '### result_dict = {'concept_drift' : ['No'], 'change_pattern' : ['None'], 'activities' : ['None']} 
    or '### result_dict = {'concept_drift' : ['Yes'], 'change_pattern' : ['pattern_name'], 'activities' : ['A', 'B']}. 
    


controlflow_change_patterns:
    - sre_instructions: | 
        Serial-Switch:
         - If the new activity is added in a Sequence fragment between two existing activities or the deleted activity was in a Sequence fragment between two existing activities then is Serial-Switch pattern. 
         - For example, the BPMN diagram could change from 'Sequence(A, B)' to 'Sequence(A, C, B)' or vice versa, where C is the activity involved.
         - Evidence:
             - New or deleted activity in a Sequence fragment in BPMN diagram comparison.
             - New or deleted activity in the list of variations.
    
    - pre_instructions: |
        Parallel-Switch:
         - If the new activity is added in a Parallel fragment or the deleted activity was in a Parallel fragment then is Parallel-Switch pattern.
         - For example, the BPMN diagram could change from 'Sequence(A, B, C)' to 'Sequence(A, Parallel(B, D), C)' or vice versa, where D is the activity involved.
         - Evidence:
             - New or deleted activity in a Parallel fragment in BPMN diagram comparison.
             - New or deleted activity in the list of variations.
    
    - cre_instructions: |
        Conditional-Switch:
         - If the new activity is added in a conditional fragment or the deleted activity was in a conditional fragment then is Conditional-Switch pattern. 
         - For example, the BPMN diagram could change from 'Sequence(A, B, C)' to 'Sequence(A, Conditional(B, D), C)' or vice versa, where D is the activity involved.
         - Evidence:
             - New or deleted activity in a Conditional fragment in BPMN diagram comparison.
             - New or deleted activities in the list of variations.
    
    - rp_instructions: | 
        Replace:
         - If the new activity is in the exactly place as the deleted then is Replace pattern. 
         - For example, the BPMN diagram could change from 'Sequence(A, B, C)' to 'Sequence(A, D, C)', where B and D are the activities involved.
         - Evidence:
             - Activities replaced in the BPMN diagram comparison.
             - Both new and deleted activities in any fragment in BPMN diagram comparison.
             - Both new and deleted activities in the list of variations.

    - sm_instructions: |
        Serial-Move:
         - If an activity has moved in the BPMN diagram into a Sequence fragment between two existing activities then is Serial-Move pattern.
         - For example, the BPMN diagram could change from 'Sequence(A, B, C, D, E)' to 'Sequence(A, C, D, B, E)', where B is the activity involved.
         - Evidence:
             - New or deleted Sequence fragment in BPMN diagram comparison.
             - Activity moved globally to or from a Sequence fragment in BPMN diagram comparison.
             - Both new and deleted transitions in the list of variations involving the moved activity.
             
    
    - pm_instructions: |
        Parallel-Move:
         - If an activity has moved in the BPMN diagram into a Parallel fragment then is Parallel-Move pattern. 
         - For example, the BPMN diagram could change from 'Sequence(A, B, C, D, E, F)' to 'Sequence(A, C, D, Parallel(B, E), F)', where B were moved ahead in the diagram an inserted in a new Parallel fragment with activity E.
         - Evidence:
             - New or deleted Parallel fragment in BPMN diagram comparison.
             - Activity moved globally to or from a Parallel fragment in BPMN diagram comparison.
             - Both new and deleted transitions in the list of variations involving the moved activity.
    
    - cm_instructions: |
        Conditional-Move:
         - If an activity has moved in the BPMN diagram into a Conditional fragment then is Conditional-Move pattern.
         - For example, the BPMN diagram could change from 'Sequence(A, B, C, D, E, F)' to 'Sequence(A, C, D, Conditional(B, E), F)', where B were moved ahead in the diagram an inserted in a new Conditional fragment with activity E.
         - Evidence:
             - New or deleted Conditional fragment in BPMN diagram comparison.
             - Activity moved globally to or from a Conditional fragment in BPMN diagram comparison.
             - Both new and deleted transitions in the list of variations involving the moved activity.
    
    - sw_instructions: |
        Swap:
         - If two activities or two combinations of activities were swapped in the BPMN diagram then is Swap pattern.
         - For example:
            - The BPMN diagram could change from 'Sequence(A, B, C, D, E, F, G, H)' to 'Sequence(A, G, D, E, F, B, C, H)', where activities B and C were moved to the exact position of G, and G were moved to the exact position of B and C.
            - The BPMN diagram could change from 'Sequence(A, Parallel(B, C), D)' to 'Sequence(Parallel(B, C), A, D)', where activities A were moved to the exact position of the Parallel fragment Parallel(B, C) and Parallel(B, C) were moved to the exact position of A.
         - Evidence:
             - Activities swapped in BPMN diagram comparison.
             - Activities moved in the BPMN diagram comparison.
             - Both new and deleted transitions in the list of variations involving the swapped activities.

    - pl_instructions: |
        Parallel-To-Sequence:
         - If two connected activities changed from a Sequence to a Parallel fragment or from a Parallel to Sequence then is Parallel-To-Sequence pattern. 
         - For example, the BPMN diagram could change from 'Sequence(A, B, C, D)' to 'Sequence(A, Parallel(B, C), D)' or vice versa, where B and C weren't moved, but just inserted in a new Parallel fragment.
         - Evidence:
             - New or deleted Parallel fragment in BPMN diagram comparison.
             - Activity moved locally to or from a Parallel fragment in BPMN diagram comparison.
             - New (and sometimes deleted) transitions in the list of variations involving the activities included to or excluded from the Parallel fragment.
    
    - cf_instructions: |
        Conditional-To-Sequence:
         - If two connected activities changed from a Sequence to a Conditional fragment or from a Conditional to Sequence then is a Conditional-To-Sequence pattern.
         - For example, the BPMN diagram could change from 'Sequence(A, B, C, D)' to 'Sequence(A, Conditional(B, C), D)' or vice versa, where B and C weren't moved, but just inserted in a new Conditional fragment.
         - Evidence:
             - New or deleted Conditional fragment in BPMN diagram comparison.
             - Activity moved locally to or from a Conditional fragment in BPMN diagram comparison.
             - New (and sometimes deleted) transitions in the list of variations involving the activities included to or excluded from the Conditional fragment.

    - cd_instructions: |
        Control-Dependancy:
         - If a Parallel fragment is restructured, involving a reordered sequence of activities,then is Control-Dependancy pattern. 
         - For example, the BPMN diagram could change from 'Sequence(A, Parallel(B, Sequence(C, D)), E)' to 'Sequence(A, Sequence(Parallel(B, C), D), E)' or vice versa, where B, C, and D are the activities involved.
         - Evidence:
             - Parallel fragment is restructured in BPMN diagram comparison, involving a reordered sequence of activities.
             - Activities were in a Parallel fragment and now they are sequence within this Parallel fragment or one of them is outside the fragment but the right next activity.
             - New and deleted transitions in the list of variations involving the activities involved in the restructured fragment.
             - Involved activities moved locally inside the Parallel fragment or outside the Parallel fragment.

    - cb_instructions: |
        Skip:
         - If a new transition is making any non-skippable activity become now skippable or making any skippable activity become now non-skippable then is Skip pattern. 
         - For example, the BPMN diagram could change from 'Sequence(A, B, C)' to 'Sequence(A, Conditional(B, 'tau'), C)' or vice versa, where B is the activity involved.
         - Evidence:
             - New or deleted transitions in the list of variations involving activities that isn't right next to the other in BPMN diagram.
             - May be a new or deleted conditional fragment in BPMN diagram comparison with a silent transition ('tau'). Sometimes the silent transitions ('tau') will not be detect correctly, so rely on the new or deleted transitions in the list of variations.
             - Involved activities moved locally.
    
    - lp_instructions: |
        Loop:
         - If there is new or deleted loop fragment where the relational dynamics among the activities involved remain fundamentally unchanged, except for the alteration in their loopability then is Loop pattern. 
         - For example, the BPMN diagram could change from 'Sequence(A, B, C, D, E)' to 'Sequence(A, Loop(B, C, D), E)' or vice versa or vice versa, where B, C, and D are the activities involved.
         - Evidence:
             - New or deleted Loop fragment in BPMN diagram comparison.
             - New and deleted transitions in the list of variations involving the activities in the new or deleted loop.
             - Involved activities moved locally to or from a Loop fragment in BPMN diagram comparison.
             - The structure inside the new or deleted loop remain fundamentally unchanged in the detection BPMN diagram compared with the reference BPMN diagram.

    - fr_instructions: | 
        Frequency:
         - If there are transitions with variances without control-flow changes, then is Frequency pattern. 


# - cp_instructions: |
#     Copy:
#         - If there is new or deleted loop fragment with only Conditional that encapsulates multiple activities and silent transition ('tau'), and the structure inside the new or deleted loop drastically changes, then is Copy pattern. 
#         - For example, the BPMN diagram could change from 'Sequence(A, B, C, Parallel(D, E), F, G, H)' to 'Sequence(A, B, Loop(Conditional(C, D, E, F, G), 'tau'), H)' or vice versa or vice versa, where C, D, E, F and G could be the activities involved.
#         - Evidence:
#             - New or deleted Loop fragment with a conditional fragment and a silent transition ('tau') in BPMN diagram comparison.
#             - New and deleted transitions in the list of variations involving the activities in the new or deleted loop.
#             - The structure inside the new or deleted loop drastically changes in the detection BPMN diagram compared with the reference BPMN diagram.
#         Note: Report as involved activities only activities in new transitions in the list of variations.



# BPMN diagrams comparison demonstrations:
# 1. Demonstration:
#     Provided informations:
#         - The BPMN before the concept drift (reference window): ->(A, B, C, D, E).
#         - The BPMN after the concept drift (detection window): ->(A, X(B, C), D, E).
#     - BPMN diagrams Comparison Analysis: 
#         - Inclusion or exclusion of control-flow operators: 
#             - A new conditional (X) fragment was added in the detection window, including activity 'B' in one branch and activity 'E' in the other branch, were before they were in a sequential fragment.
#         - Changes in order within sequence flows:
#             - No activity was moved.
#         - Changes in loops and silent transitions:
#             - No loop or silent transitions were added or deleted.

# 2. Demonstration:
#     Provided informations:
#         - The BPMN before the concept drift (reference window): ->(A, C, D, X(B, E)).
#         - The BPMN after the concept drift (detection window): ->(A, B, C, D, E).
#     - BPMN diagrams Comparison Analysis: 
#         - Inclusion or exclusion of control-flow operators: 
#             - A conditional (X) fragment was deleted in the detection window, including activity 'B' in one branch and activity 'E' in the other branch, that are now in a sequential fragment. 
#         - Changes in order within sequence flows:
#             - Activity 'B' was moved two items behind in the sequential fragment.
#         - Changes in loops and silent transitions:
#             - No loop or silent transitions were added or deleted.

#     3. Demonstration:
#     Provided informations:
#         - The BPMN before the concept drift (reference window): ->(A, B, X(C, D), E, F).
#         - The BPMN after the concept drift (detection window): ->(F, B, X(D, C), E, A).
#     - BPMN diagrams Comparison Analysis: 
#         - Inclusion or exclusion of control-flow operators: 
#             - No new or deleted sequences, parallels, or conditionals. 
#         - Changes in order within sequence flows:
#             - Activity 'A' and activity 'F' were moved to the same position of each other in the BPMN diagram, thus, they swapped positions in the BPMN diagram.
#         - Changes in loops and silent transitions:
#             - No loop or silent transitions were added or deleted.






# instructions_unified: |
#     ### Introduction ###
#     You are a technical analyst specializing in concept drift in process mining. 
#     Your primary role is to investigate the phenomenon of concept drift by comparing two distinct phases of a business process: the reference window (before the change) and the detection window (after the change).
#     Think step by step.


#     ### BPMN diagrams Comparison ###
#     You will be provided with detailed BPMN diagrams for both time frame (reference and detection windows). Compare the BPMN diagrams identifying and highlighting if there are any differences regarding:
#         - Inclusion or exclusion of control-flow operators (sequentials, parallels, or conditionals fragments).
#         - Changes in order within sequence flows. For example, (A, B, C) and (C, B, A) would indicate that 'A' and 'C' changed their order in the BPMN diagram. In this specific example, 'C' and 'A' are swapped.
#         - Changes in loops and silent transitions ('tau'), which can indicate the skippability of an activity.

#     To be able to compare the BPMN diagrams you need a solid grasp of BPMN symbols.
#     Such understanding is crucial for identifying structural changes within the diagrams, including modifications in sequences, parallelisms, conditional flows, loops, and silent transitions.
#     BPMN Symbols:  
#         - Sequential fragments are denoted by '->'. 
#         - Parallel fragments by '+'.
#         - Conditional fragments by 'X'. 
#         - Looping fragments by '*'.
#         - Silent transitions are indicated by 'tau'.
#         - Nested fragments are enclosed in parentheses '()'.
#         - Items within a fragment are separated by commas.

#     For example: 
#         - In the BPMN diagram notation ->(A, X(B, ->(C, D)), E), the structure is as follows:
#             - The outermost fragment is a sequential fragment ('->'), indicating that its components follow one after another.
#             - Within this sequential fragment, there are three main items:
#                 - 'A' is a standalone activity.
#                 - A conditional fragment ('X') that contains further nested activities and fragments. Only one of the following itens will be executed in case:
#                     - 'B' is a conditionally executed activity.
#                     - A nested sequential fragment ('->'), containing activities 'C' and 'D'.
#                 - 'E' is another activity that is part of the outer sequential fragment, following the conditional fragment.



#     ### Transition and Activities analysis ###
#     You will be provided with lists showing all activities and transitions changes between the reference and detection windows in the following format:
#         - New transitions added to the process
#         - Deleted transitions from the process
#         - New activities added to the process
#         - Deleted activities from the process

#     Based on them, you will need to:
#         - Check if the BPMN diagrams comparison analysis are considering the changes in the lists. 
#         - These lists may contain changes that are not explicitly represented in the BPMN diagrams, especially silent transitions that makes activities become skippable. 
#         - If the BPMN diagrams comparison analysis are incorrect or are missing some information, correct it or add new informations to the analysis. 
        

#     ### Change pattern classification ###
#     You will be provided with a list of pre-defined change patterns. You can find a brief description of each of them, as well as examples using a BPMN diagram and a list of evidences that can help confirm the pattern.
#     Combine all informations previously analyzed and make a final and conclusive holistic analysis.
#     Classify whether a concept drift occurred and identify the most significant change pattern that has occurred and identify which activities are involved. 
    

#     ### Output Formating ###
#     Format your conclusion as follows, providing a clear and concise verdict on whether the change pattern is present: 
#     '### result_dict = {'concept_drift' : ['No'], 'change_pattern' : ['None'], 'activities' : ['None']} 
#     or '### result_dict = {'concept_drift' : ['Yes'], 'change_pattern' : ['pattern_acronym'], 'activities' : ['A', 'B']}. 


#     ### Demonstrations ###
#     1. Demonstration:
#         Provided informations:
#             - The BPMN before the concept drift (reference window): ->(A, B, C, D, E).
#             - The BPMN after the concept drift (detection window): ->(A, X(B, C), D, E).
#             - Transition and Activities comparison lists (provided):
#                 - New transitions added to the process: [('A', 'C'), ('B', 'D')]
#                 - Deleted transitions from the process: ['None']
#                 - New activities added to the process: ['None']
#                 - Deleted activities from the process: ['None']
#         - BPMN diagrams Comparison Analysis: 
#             - Inclusion or exclusion of control-flow operators: 
#                 - A new conditional (X) fragment was added in the detection window, including activity 'B' in one branch and activity 'C' in the other branch. 
#             - Changes in order within sequence flows:
#                 - No activity was moved.
#             - Changes in loops and silent transitions:
#                 - No loop or silent transitions were added or deleted.
#         - Transition and Activities analysis:
#             - New transitions were added to the process:
#                 - ('A', 'C') means that activity 'A' can now be followed by activity 'C' in the detection window. Since activity 'C' was included in a new conditional (X) fragment just after activity 'A' in the sequential fragment, this new transition is aligned correctly with the BPMN diagrams comparison analysis.
#                 - ('B', 'D') means that activity 'B' can now be followed by activity 'D' in the detection window. Since activity 'B' was included in a new conditional (X) fragment just before activity 'D' in the sequential fragment, this new transition is aligned correctly with the BPMN diagrams comparison analysis.
#         - Change pattern classification:
#             - In summary, a new conditional (X) fragment was added in the detection window, including activity 'B' in one branch and activity 'C' in the other branch according to the BPMN diagrams comparison analysis and confirmed by the transition and activities analysis.
#             - Therefore, we conclude that:
#                 - A concept drift occurred in the detection window since occurred a change in the control-flow of the process.
#                 - Since two connected activities changed from a sequential to a Conditional (X) fragment then is a CF pattern. Evidences:
#                     - New conditional (X) fragment in BPMN diagram comparison.
#                     - New transitions in the list of variations involving the activities included to the new Conditional (X) fragment.
#                     - Involved activities aren't moved in BPMN diagram.
#                 - Activities involved in the new Conditional (X) fragment are 'B' and 'C'.
#         - Output Formating:
#             - result_dict = {'concept_drift' : ['Yes'], 'change_pattern' : ['CF'], 'activities' : ['B', 'C']}

#     2. Demonstration:
#         Provided informations:
#             - The BPMN before the concept drift (reference window): ->(A, B, C, D, E).
#             - The BPMN after the concept drift (detection window): ->(A, C, D, X(B, E)).
#             - Transition and Activities comparison lists (provided):
#                 - New transitions added to the process: [('A', 'C'), ('D', 'B')]
#                 - Deleted transitions from the process: [('A', 'B'), ('B', 'C')]
#                 - New activities added to the process: ['None']
#                 - Deleted activities from the process: ['None']
#         - BPMN diagrams Comparison Analysis: 
#             - Inclusion or exclusion of control-flow operators: 
#                 - A new conditional (X) fragment was added in the detection window, including activity 'B' in one branch and activity 'E' in the other branch. 
#             - Changes in order within sequence flows:
#                 - Activity 'B' was moved two items ahead in the sequential fragment and included in the new conditional (X) fragment.
#             - Changes in loops and silent transitions:
#                 - No loop or silent transitions were added or deleted.
#         - Transition and Activities analysis:
#             - New transitions were added to the process:
#                 - ('A', 'C') means that activity 'A' can now be followed by activity 'C' in the detection window. Since activity 'B' was moved two items ahead in the sequential fragment and activity 'A' is followed by activity 'C' in the detection window, this new transition is aligned with the detection BPMN diagram and considered in the BPMN diagrams comparison analysis.
#                 - ('D', 'B') means that activity 'D' can now be followed by activity 'B' in the detection window. Since activity 'B' was moved two items ahead in the sequential fragment and activity 'D' is followed by the new conditional (X) fragment which includes activity 'B' in the detection window, this new transition is aligned with the detection BPMN diagram and considered in the BPMN diagrams comparison analysis.
#             - Deleted transitions from the process:
#                 - ('A', 'B') means that activity 'A' no longer can be followed by activity 'B' in the detection window. Since activity 'B' was moved two items ahead in the sequential fragment and activity 'A' is followed by activity 'C' in the detection window, this deleted transition is aligned with the detection BPMN diagram and considered in the BPMN diagrams comparison analysis.
#                 - ('B', 'C') means that activity 'B' no longer can be followed by activity 'C' in the detection window. Since activity 'B' was moved two items ahead in the sequential fragment and activity 'C' is followed by activity 'D' in the detection window, this deleted transition is aligned with the detection BPMN diagram and considered in the BPMN diagrams comparison analysis.
#         - Change pattern classification:
#             - In summary, a new conditional (X) fragment was added in the detection window, including activity 'B' in one branch and activity 'E' in the other branch, and activity 'B' was moved two items ahead in the sequential fragment, according to the BPMN diagrams comparison analysis and confirmed by the transition and activities analysis.
#             - Therefore, we conclude that:
#                 - A concept drift occurred in the detection window since occurred a change in the control-flow of the process.
#                 - Since an activity was moved in the BPMN diagram into a Conditional (X) fragment then is a CM pattern. Evidences:
#                     - Activity moved to a Conditional (X) fragment in BPMN diagram comparison.
#                     - New conditional (X) fragment in BPMN diagram comparison.
#                     - Both new and deleted transitions in the list of variations involving the moved activity.
#         - Output Formating:
#             - result_dict = {'concept_drift' : ['Yes'], 'change_pattern' : ['CM'], 'activities' : ['B']}

#     3. Demonstration:
#         Provided informations:
#             - The BPMN before the concept drift (reference window): ->(A, B, C, D, E).
#             - The BPMN after the concept drift (detection window): ->(A, B, C, D, E).
#             - Transition and Activities comparison lists (provided):
#                 - New transitions added to the process: [('B', 'D')]
#                 - Deleted transitions from the process: ['None']
#                 - New activities added to the process: ['None']
#                 - Deleted activities from the process: ['None']
#         - BPMN diagrams Comparison Analysis: 
#             - Inclusion or exclusion of control-flow operators: 
#                 - No new or deleted sequences, parallels, or conditionals. 
#             - Changes in order within sequence flows:
#                 - No activity was moved.
#             - Changes in loops and silent transitions:
#                 - No loop or silent transitions were added or deleted.
#         - Transition and Activities analysis:
#             - New transitions were added to the process:
#                 - ('B', 'D') means that activity 'B' can now be followed by activity 'D' in the detection window. This new transition isn't aligned with the detection BPMN diagram and isn't considered in the BPMN diagrams comparison analysis. We need to analyze it further:
#                     - According with the detection BPMN diagram, activity 'B' and activity 'D' are items in the same sequential fragment but are not followed by each other. They are separeted by just one item in the sequential fragment, which is activity 'C'. Therefore, the most likely explanation is that activity 'C' can now be skipped in the detection window.
#         - Change pattern classification:
#             - In summary, a new transition was added in the detection window, including activity 'B' and activity 'D'. This new transition is not represented in the detection BPMN diagram, but the most likely explanation is that activity 'C' can now be skipped in the detection window.
#             - Therefore, we conclude that:
#                 - A concept drift occurred in the detection window since occurred a change in the control-flow of the process.
#                 - Since the new transition is making an activity become skippable then is a CP pattern. Evidences:
#                     - New transition in the list of variations involving the activities that isn't right next to the other in BPMN diagram.
#                     - The silent transition ('tau') wasn't detected correctly, so we need to rely on the new transitions in the list of variations.
#                     - Involved activities aren't moved in BPMN diagram.
#             - Output Formating:
#                 - result_dict = {'concept_drift' : ['Yes'], 'change_pattern' : ['CP'], 'activities' : ['C']}

#         4. Demonstration:
#         Provided informations:
#             - The BPMN before the concept drift (reference window): ->(A, B, X(C, D), E, F).
#             - The BPMN after the concept drift (detection window): ->(F, B, X(D, C), E, A).
#             - Transition and Activities comparison lists (provided):
#                 - New transitions added to the process: [('F', 'B'), ('E', 'A')]
#                 - Deleted transitions from the process: [('A', 'B'), ('E', 'F')]
#                 - New activities added to the process: ['None']
#                 - Deleted activities from the process: ['None']
#         - BPMN diagrams Comparison Analysis: 
#             - Inclusion or exclusion of control-flow operators: 
#                 - No new or deleted sequences, parallels, or conditionals. 
#             - Changes in order within sequence flows:
#                 - Activity 'A' and activity 'F' were moved to the same position of each other in the BPMN diagram, thus, they swapped positions in the BPMN diagram.
#             - Changes in loops and silent transitions:
#                 - No loop or silent transitions were added or deleted.
#         - Transition and Activities analysis:
#             - New transitions were added to the process:
#                 - ('F', 'B') means that activity 'F' can now be followed by activity 'B' in the detection window. Since activity 'F' is now the activity right before activity 'B' in the sequential fragment, this new transition is aligned with the detection BPMN diagram and considered in the BPMN diagrams comparison analysis.
#                 - ('E', 'A') means that activity 'E' can now be followed by activity 'A' in the detection window. Since activity 'A' is now the activity right after activity 'E' in the sequential fragment, this new transition is aligned with the detection BPMN diagram and considered in the BPMN diagrams comparison analysis.
#             - Deleted transitions were removed from the process:
#                 - ('A', 'B') means that activity 'A' no longer can be followed by activity 'B' in the detection window. Since activity 'A' were moved, this deleted transition is aligned with the detection BPMN diagram and considered in the BPMN diagrams comparison analysis.
#                 - ('E', 'F') means that activity 'E' no longer can be followed by activity 'F' in the detection window. Since activity 'F' were moved, this deleted transition is aligned with the detection BPMN diagram and considered in the BPMN diagrams comparison analysis.
#         - Change pattern classification:
#             - In summary, activity 'A' and activity 'F' were moved to the same position of each other in the BPMN diagram, thus, they swapped positions in the BPMN diagram, according to the BPMN diagrams comparison analysis and confirmed by the transition and activities analysis. 
#             - Therefore, we conclude that:
#                 - A concept drift occurred in the detection window since occurred a change in the control-flow of the process.
#                 - Since two activities have moved in the BPMN diagram to the position of each other in the BPMN diagram then is SW pattern. Evidences:
#                     - Activities swapped in BPMN diagram comparison.
#                     - Both new and deleted transitions in the list of variations involving the swapped activities.
#         - Output Formating:
#             - result_dict = {'concept_drift' : ['Yes'], 'change_pattern' : ['SW'], 'activities' : ['A', 'F']}












#     - The BPMN before the concept drift (reference window): ->(A, X(B, ->(C, D)), ->(E, F)).
#     - The BPMN after the concept drift (detection window): ->(->(E, F), X(B, ->(C, D)), A).
#     - BPMN diagrams Comparison Analysis:
#         - Inclusion or exclusion of control-flow operators: 
#             - No new or deleted sequences, parallels, or conditionals.
#         - Changes in order within sequence flows:
#             - Activities 'A' and the sequential fragment ->(E, F) swapped positions inside the outermost sequential fragment.
#         - Changes in loops and silent transitions:
#             - No loop or silent transitions were added or deleted.
# 3. Demonstration:
#     - The BPMN before the concept drift (reference window): ->(A, B, C, D, E, F).
#     - The BPMN after the concept drift (detection window): ->(*(->(A, B)), C, X(D, 'tau'), E, F).
#     - BPMN diagrams Comparison Analysis:
#         - Inclusion or exclusion of control-flow operators:
#             - A new sequential fragment was added in the detection window, including activities 'A' and 'B'.
#             - New loop ('*') fragment was added in the detection window, including the new sequential fragment with activities 'A' and 'B'.
#             - New coditional (X) fragment was added in the detection window, including activity 'D' in one branch and a 'tau' in the other branch.
#         - Changes in order within sequence flows:
#             - No activity was moved.
#         - Changes in loops and silent transitions:
#             - New silent transition ('tau') was added in the detection window in a conditional (X) fragment with activity 'D', which means that the activity 'D' become skippable.
















# Transition and Activities analysis demonstration:
#     1. Demonstration:
#         - BPMN diagram comparation (from the previous step): 
#             - The BPMN before the concept drift (reference window): ->('A', 'B', 'C', 'D', *( X( 'E', 'F' ), tau )).
#             - The BPMN after the concept drift (detection window): ->('A', 'C', X( 'B', 'D' ), *( X( 'E', 'F' ), tau )).
#             - Analysis:
#                 - New conditional (X) fragment was added in the detection window, including activities 'B' and 'D'.
#                 - Movement: 
#                     - Activity 'C' was moved inside the sequential fragment right after activity 'A'.
#                     - Activity 'B' was moved inside the sequential fragment to inside the conditional fragment with activity 'D', which is executed right after activity 'C'.
#                 - No silent transitions were added or deleted.
#         - Transition and Activities comparison lists (provided):
#             - New transitions added to the process: [('C', 'B'), ('B', 'F'), ('A', 'C')]
#             - Deleted transitions from the process: [('B', 'C'), ('A', 'B')]
#             - New activities added to the process: ['None']
#             - Deleted activities from the process: ['None']
#         - Transition and Activities analysis:
#             - New transitions were added to the process:
#                 - ('C', 'B') is a new transition added due to the inclusion of the conditional (X) fragment in the detection window after activity 'C', where activity 'B' is included. This transition is considered correctly in the BPMN diagrams comparison analysis.
#                 - ('B', 'F') is a new transition added in the detection window but there is no consideration in the BPMN diagrams comparison analysis. Let's analyze it further in the detection window:
#                     - Activity 'B' is in a conditional (X) fragment with activity 'D', where any one of the items can be executed.
#                     - After activity 'B' is executed,  the next item is a loop fragment with a conditional (X) fragment with activity 'E' and activity 'F', or a silent transition ('tau'), where any one of the items can be executed. 
#                     - So, 'F' can be executed right after 'B'. Therefore, this new transition is correctly represented in the BPMN diagram and is due the new conditional (X) fragment in the detection window which activity 'B' was included.
#                 - ('A', 'C') is a new transition added in the detection window due to the movement of activity 'C', which is correctly represented in the BPMN diagram and in the analysis.
#             - Deleted transitions from the process:
#                 - ('B', 'C') is a deleted transition due to the movement of activity 'C' and 'B' in the detection window. This transition is considered correctly in the BPMN diagrams comparison analysis.
#                 - ('A', 'B') is a deleted transition due to the movement of activity 'B' in the detection window. This transition is considered correctly in the BPMN diagrams comparison analysis.
#     2. Demonstration:
#         - BPMN diagram comparation (from the previous step): 
#             - The BPMN before the concept drift (reference window): ->(A, B, C, D, E, F).
#             - The BPMN after the concept drift (detection window): ->(*(->(A, B)), C, D, E, F).
#             - Analysis:
#                 - New loop ('*') fragment was added in the detection window, including a sequential with activities 'A' and 'B'.
#                 - No activity was moved.
#                 - No silent transitions were added or deleted.
#         - Transition and Activities comparison lists (provided):
#             - New transitions added to the process: [('B', 'A'), ('C', 'E')]
#             - Deleted transitions from the process: ['None']
#             - New activities added to the process: ['None']
#             - Deleted activities from the process: ['None']
#         - Transition and Activities analysis:
#             - New transitions were added to the process:
#                 - ('B', 'A') is a new transition added due to the inclusion of the loop ('*') fragment in the detection window. This transition is considered correctly in the BPMN diagrams comparison analysis.
#                 - ('C', 'E') is a new transition added in the detection window but there is no consideration in the BPMN diagrams comparison analysis. Let's analyze it further in the detection window:
#                     - Activity 'C' is in a sequential fragment.
#                     - After activity 'C' is executed, the next item is activity 'D'.
#                     - After activity 'D' is executed, the next item is activity 'E'.
#                     - So, activity 'E' can't be executed right after activity 'C'. This transition is jumping through 'D'.
#                     - Therefore, this new transition is incorrectly represented in the BPMN diagram and is due a silent transition ('tau') missing that makes activity 'D' skippable.









# which connects two activities that seems be far away from each other. Let's analyze it further:
#                         - According with the detection BPMN diagram, activity 'B' is in conditional (X) fragment with activity 'D', which means either 'B' or 'D' can be executed.
#                         - According with the detection BPMN diagram, activity 'F' is in conditional (X) fragment with activity 'E', and this conditional fragment is in a loop fragment with a silent transition '(tau'). This means that either 'E' or 'F' or none ('tau') or any combination can be executed due to the loop.
#                         - Since the conditional fragment of activity 'B' is right before the loop and conditional fragment of activity 'F', that means that activity 'F' can be executed right after activity 'B'. 
#                         - Therefore, this new transition is correctly represented in the BPMN diagram.
# - Compare both windows with these news informations regarding:
#             - Changes in the control-flow such as sequences, parallels, and conditionals.
#             - Changes in activities movements within the flow.
#             - Changes in loops and silent transitions ('tau'), which can indicate the skippability of an activity.
# bpmn_diagram_enhance: |
#     ### Introduction ###
#     You are an expert in BPMN (Business Process Model and Notation) and Process Mining. 
#     You will receive two BPMN diagrams from two different time frames: one before (reference window) and one after (detection window) a concept drift. 
#     Your task is to enhance and correct these diagrams, which may be incomplete or incorrect, using the provided information about the transitions and activities in both windows.
#     Break down the process step-by-step. Start by understanding the provided BPMN diagrams and then incorporate the detailed data of transitions and activities to identify and correct any discrepancies.
#     In the end, output the revised bpmn diagrams in this format: 
#         ### BPMN diagrams revised ###
#         result_dict = {'reference_bpmn_text' : [revised reference bpmn diagram], 'detection_bpmn_text' : [revised detection bpmn diagram]}

#     ### BPMN diagrams understanding ###
#     A solid understanding of BPMN symbols is essential to identify structural changes. These changes may include modifications in sequences, parallelisms, conditional flows, loops, and silent transitions.

#     Understand BPMN Symbols: 
#         - Sequential fragments: '->'
#         - Parallel fragments: '+'
#         - Conditional fragments: 'X'
#         - Looping fragments: '*'
#         - Silent transitions: 'tau'
#         - Nested fragments: '()'
#         - Items within a fragment are separated by commas

#     Example: In the BPMN notation `->(A, X(B, ->(C, D)), E)`:
#         - The outermost fragment is a sequential fragment ('->'), indicating a sequence.
#         - The fragment contains three main items:
#             - A: a standalone activity.
#             - X: a conditional fragment, containing:
#                 - B: a conditional activity.
#                 - ->(C, D): a nested sequential fragment with activities C and D.
#             - E: another standalone activity following the conditional fragment.

#     ### Tasks ### 
#     1. **Understand the Provided BPMN Diagrams**
#     2. **Analyze the Detailed Data of Transitions and Activities**
#     3. **Identify and Correct Discrepancies**
#         - Start analysing the news and deleted activities and transitions.
#         - If any activity or transition is missing from the bpmn, make a detailed analysis of all activities envolved. Understand all relationship these activities have with any other activities.
#         - Investigate any transformations affecting the skippability of activities. In this case, you can use a XOR with a 'tau' to skip activities.
#     4. **Revise the BPMN Diagrams and format output**
#         - Activities can't appear multiple times.






